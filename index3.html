<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Management Toolkit - Rice Vendor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f5f1e8 0%, #e8e0d5 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2d3436;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #3d5a2c 0%, #5a7c3e 100%);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-icon {
            font-size: 56px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .header h1 {
            font-size: 36px;
            font-weight: 700;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
            margin-top: 5px;
        }

        .nav-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .tab-btn {
            padding: 14px 28px;
            background: #f8f9fa;
            color: #2d3436;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
        }

        .tab-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #3d5a2c 0%, #5a7c3e 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(61, 90, 44, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .stat-card {
            padding: 28px;
            border-radius: 16px;
            color: white;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.2);
        }

        .stat-card h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            opacity: 0.95;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .amount {
            font-size: 40px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
        }

        .green-card { background: linear-gradient(135deg, #4a7c3e 0%, #5a8c4e 100%); }
        .beige-card { background: linear-gradient(135deg, #c9a961 0%, #d4b76e 100%); }
        .orange-card { background: linear-gradient(135deg, #c67d3e 0%, #d68c4a 100%); }
        .red-card { background: linear-gradient(135deg, #a84c3e 0%, #b85d4f 100%); }

        .chart-container {
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .chart-container h3 {
            margin-bottom: 24px;
            color: #2d3436;
            font-size: 24px;
            font-weight: 700;
        }

        .form-section {
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .form-section h3 {
            color: #2d3436;
            margin-bottom: 24px;
            font-size: 24px;
            font-weight: 700;
            border-bottom: 3px solid #5a7c3e;
            padding-bottom: 12px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 10px;
            color: #2d3436;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            padding: 14px 16px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            background: #f8f9fa;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #5a7c3e;
            background: white;
            box-shadow: 0 0 0 3px rgba(90, 124, 62, 0.1);
        }

        .form-group input.invalid,
        .form-group select.invalid {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .form-group input.invalid:focus,
        .form-group select.invalid:focus {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.15);
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3d5a2c 0%, #5a7c3e 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(61, 90, 44, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(61, 90, 44, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(61, 90, 44, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #a84c3e 0%, #b85d4f 100%);
            color: white;
            padding: 10px 20px;
            font-size: 13px;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(168, 76, 62, 0.3);
        }

        .btn-danger:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(168, 76, 62, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #4a7c3e 0%, #5a8c4e 100%);
            color: white;
        }

        .btn-clear {
            background: linear-gradient(135deg, #6c757d 0%, #7d8894 100%);
            color: white;
            margin-left: 12px;
        }

        .btn-clear:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }

        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .table-container h3 {
            padding: 24px 24px 0 24px;
            color: #2d3436;
            font-size: 22px;
            font-weight: 700;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, #3d5a2c 0%, #5a7c3e 100%);
            color: white;
        }

        th {
            padding: 18px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 18px;
            border-bottom: 1px solid #e1e8ed;
            color: #2d3436;
            font-size: 15px;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        .status-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
        }

        .status-paid { background: #d4edda; color: #155724; }
        .status-unpaid { background: #f8d7da; color: #721c24; }
        .status-partial { background: #fff3cd; color: #856404; }

        .chart-wrapper {
            background: #f5ede1;
            padding: 24px;
            border-radius: 12px;
            border: 2px solid #d4c4a8;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 320px;
            gap: 20px;
            padding: 20px 10px 10px 10px;
        }

        .bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .bars {
            display: flex;
            gap: 12px;
            align-items: flex-end;
            height: 100%;
            width: 100%;
            justify-content: center;
        }

        .bar {
            width: 42px;
            border-radius: 6px 6px 0 0;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .bar:hover {
            opacity: 0.85;
            transform: translateY(-4px);
        }

        .income-bar { background: linear-gradient(to top, #4a7c3e, #5a8c4e); }
        .expense-bar { background: linear-gradient(to top, #c67d3e, #d68c4a); }

        .day-label {
            font-weight: 600;
            color: #2d3436;
            font-size: 14px;
            margin-top: 8px;
        }

        .chart-legend {
            display: flex;
            gap: 24px;
            justify-content: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #d4c4a8;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: #2d3436;
        }

        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 4px;
        }

        .net-profit {
            text-align: center;
            margin-top: 24px;
            padding: 20px;
            background: linear-gradient(135deg, #4a7c3e 0%, #5a8c4e 100%);
            border-radius: 12px;
            font-size: 28px;
            font-weight: 700;
            color: white;
            box-shadow: 0 4px 12px rgba(74, 124, 62, 0.3);
        }

        .budget-summary {
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }

        .budget-summary h3 {
            color: #2d3436;
            margin-bottom: 24px;
            font-size: 24px;
            font-weight: 700;
        }

        .budget-item {
            display: flex;
            justify-content: space-between;
            padding: 18px 20px;
            margin: 12px 0;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 600;
            align-items: center;
        }

        .budget-expected { 
            background: #c9ddc4; 
            color: #2d4a26;
            border: 2px solid #b0cca8;
        }
        .budget-planned { 
            background: #f5e9c8; 
            color: #6b5a2e;
            border: 2px solid #e8d7a8;
        }
        .budget-actual { 
            background: #f5dcc8; 
            color: #6b4a2e;
            border: 2px solid #e8c4a8;
        }
        .budget-balance { 
            background: linear-gradient(135deg, #3d5a2c 0%, #5a7c3e 100%); 
            color: white; 
            font-size: 22px;
            box-shadow: 0 4px 12px rgba(61, 90, 44, 0.3);
        }
        .budget-partial {
            background: #f5e9c8;
            color: #6b5a2e;
            border: 2px solid #e8d7a8;
        }

        .alert {
            padding: 18px 20px;
            border-radius: 10px;
            margin: 12px 0;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-success { 
            background: #c9ddc4; 
            color: #2d4a26;
            border: 2px solid #b0cca8;
        }
        .alert-warning { 
            background: #f5e9c8; 
            color: #6b5a2e;
            border: 2px solid #e8d7a8;
        }
        .alert-danger { 
            background: #f5ccc8; 
            color: #6b2e2e;
            border: 2px solid #e8a8a8;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h4 {
            font-size: 20px;
            margin-bottom: 8px;
            color: #495057;
        }

        .empty-state p {
            font-size: 15px;
        }

        .data-controls {
            background: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .data-controls p {
            flex: 1;
            min-width: 200px;
            color: #6c757d;
            font-size: 14px;
        }

        .footer-section {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            margin-top: 40px;
            padding: 32px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        .footer-info h4,
        .danger-zone h4 {
            color: #2d3436;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .footer-info p,
        .danger-zone p {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.6;
        }

        .danger-zone {
            border: 2px solid #f8d7da;
            background: #fff5f5;
            padding: 24px;
            border-radius: 12px;
        }

        .danger-zone h4 {
            color: #a84c3e;
        }

        .danger-zone p {
            color: #721c24;
            margin-bottom: 16px;
        }

        .danger-zone .btn-danger {
            width: 100%;
            padding: 14px 32px;
            font-size: 15px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .header {
                padding: 20px;
                flex-direction: column;
                text-align: center;
            }
            .header h1 { 
                font-size: 24px; 
            }
            .header p {
                font-size: 14px;
            }
            .header-icon {
                font-size: 40px;
            }
            .dashboard-grid { 
                grid-template-columns: 1fr; 
                gap: 16px;
            }
            .form-grid { 
                grid-template-columns: 1fr; 
                gap: 16px;
            }
            .stat-card {
                padding: 20px;
            }
            .stat-card .amount { 
                font-size: 32px; 
            }
            .nav-tabs {
                padding: 10px;
                gap: 8px;
            }
            .tab-btn {
                padding: 12px 16px;
                font-size: 13px;
                flex: 1 1 calc(50% - 4px);
                min-width: 140px;
            }
            .chart-bars {
                height: 220px;
                gap: 8px;
                padding: 10px 5px;
            }
            .bar {
                width: 28px;
            }
            .bars {
                gap: 6px;
            }
            .day-label {
                font-size: 12px;
            }
            .chart-legend {
                flex-direction: column;
                gap: 12px;
                align-items: center;
            }
            .net-profit {
                font-size: 22px;
                padding: 16px;
            }
            th, td {
                padding: 10px 8px;
                font-size: 13px;
            }
            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            table {
                min-width: 600px;
            }
            .btn {
                width: 100%;
                padding: 12px 24px;
            }
            .btn-danger {
                width: auto;
                padding: 8px 16px;
                font-size: 12px;
            }
            .btn-clear {
                width: 100%;
                margin-left: 0;
                margin-top: 8px;
            }
            .budget-item {
                font-size: 15px;
                padding: 14px 16px;
                flex-wrap: wrap;
                gap: 8px;
            }
            .budget-balance {
                font-size: 18px;
            }
            .form-section,
            .chart-container,
            .budget-summary {
                padding: 20px;
            }
            .form-section h3,
            .chart-container h3,
            .budget-summary h3 {
                font-size: 20px;
            }
            .alert {
                font-size: 14px;
                padding: 14px 16px;
            }
            .data-controls {
                padding: 16px;
            }
            .data-controls p {
                flex: 1 1 100%;
            }
            .footer-section {
                padding: 20px;
                margin-top: 30px;
            }
            .footer-content {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }

        @media (max-width: 480px) {
            .header h1 { 
                font-size: 20px; 
            }
            .header-icon {
                font-size: 32px;
            }
            .stat-card .amount { 
                font-size: 28px; 
            }
            .tab-btn {
                flex: 1 1 100%;
                min-width: unset;
            }
            .chart-bars {
                height: 180px;
            }
            .bar {
                width: 22px;
            }
            .bars {
                gap: 4px;
            }
            .day-label {
                font-size: 11px;
            }
            th, td {
                padding: 8px 6px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-icon">üåæ</div>
            <div>
                <h1>Financial Management Toolkit</h1>
                <p>Rice Vendor Dashboard System</p>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="tab-btn" onclick="showTab('sales')">üí∞ Sales Recording</button>
            <button class="tab-btn" onclick="showTab('credit')">üìù Credit Management</button>
            <button class="tab-btn" onclick="showTab('expenses')">üí≥ Expense Tracker</button>
            <button class="tab-btn" onclick="showTab('budget')">üìà Budget Planner</button>
            <button class="tab-btn" onclick="showTab('summary')">üìë Summary</button>
        </div>


        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="stat-card green-card">
                    <h3>Today's Sales</h3>
                    <div class="amount" id="todaySales">‚Ç±0.00</div>
                </div>
                <div class="stat-card beige-card">
                    <h3>Weekly Income</h3>
                    <div class="amount" id="weeklyIncome">‚Ç±0.00</div>
                </div>
                <div class="stat-card orange-card">
                    <h3>Total Expenses</h3>
                    <div class="amount" id="totalExpenses">‚Ç±0.00</div>
                </div>
                <div class="stat-card red-card">
                    <h3>Customer Debts</h3>
                    <div class="amount" id="customerDebts">‚Ç±0.00</div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Income & Expenses This Week</h3>
                <div class="chart-wrapper">
                    <div class="chart-bars" id="weeklyChart"></div>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(to top, #4a7c3e, #5a8c4e);"></div>
                            <span>Income</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(to top, #c67d3e, #d68c4a);"></div>
                            <span>Expenses</span>
                        </div>
                    </div>
                </div>
                <div class="net-profit">
                    Net Profit: <span id="netProfit">‚Ç±0.00</span>
                </div>
            </div>
        </div>

        <!-- SALES RECORDING TAB -->
        <div id="sales" class="tab-content">
            <div class="form-section">
                <h3>Record New Sale</h3>
                <form id="salesForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="saleDate" required>
                        </div>
                        <div class="form-group">
                            <label>Kilos Sold</label>
                            <input type="number" id="saleKilos" step="0.01" min="0.01" placeholder="25" required>
                        </div>
                        <div class="form-group">
                            <label>Price per Kilo (‚Ç±)</label>
                            <input type="number" id="salePrice" step="0.01" min="0.01" placeholder="75.00" required>
                        </div>
                        <div class="form-group">
                            <label>Transaction Type</label>
                            <select id="saleType" required>
                                <option value="Cash">Cash</option>
                                <option value="Credit">Credit</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label>Customer Name (for Credit transactions)</label>
                        <input type="text" id="saleCustomer" placeholder="Leave blank for cash sales">
                    </div>
                    <button type="submit" class="btn btn-primary">‚ûï Add Sale</button>
                </form>
            </div>

            <div class="table-container">
                <h3>Sales Record</h3>
                <table id="salesTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Kilos Sold</th>
                            <th>Price/kg</th>
                            <th>Type</th>
                            <th>Customer</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody">
                        <tr>
                            <td colspan="7">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üìä</div>
                                    <h4>No sales recorded yet</h4>
                                    <p>Start by adding your first sale above</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="form-section">
                <h3>Sales Summary</h3>
                <div class="budget-item budget-expected">
                    Daily Total: <span id="dailySalesTotal">‚Ç±0.00</span>
                </div>
                <div class="budget-item budget-balance">
                    Weekly Total: <span id="weeklySalesTotal">‚Ç±0.00</span>
                </div>
            </div>
        </div>

        <!-- CREDIT MANAGEMENT TAB -->
        <div id="credit" class="tab-content">
            <div class="form-section">
                <h3>Customer Credit Overview</h3>
                <div class="alert alert-warning">
                    üí∞ Total Outstanding Debts: <span id="totalOutstanding">‚Ç±0.00</span>
                </div>
            </div>

            <div class="table-container">
                <h3>Credit Accounts</h3>
                <table id="creditTable">
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>Amount Owed</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="creditTableBody">
                        <tr>
                            <td colspan="5">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üí≥</div>
                                    <h4>No credit transactions yet</h4>
                                    <p>Credit sales will appear here</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- EXPENSE TRACKER TAB -->
        <div id="expenses" class="tab-content">
            <div class="form-section">
                <h3>Record New Expense</h3>
                <form id="expenseForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="expenseDate" required>
                        </div>
                        <div class="form-group">
                            <label>Type of Expense</label>
                            <select id="expenseType" required>
                                <option value="Rice Supply">Rice Supply</option>
                                <option value="Utilities">Utilities</option>
                                <option value="Transportation">Transportation</option>
                                <option value="Others">Others</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Amount (‚Ç±)</label>
                            <input type="number" id="expenseAmount" step="0.01" min="0.01" placeholder="1000.00" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" id="expenseDesc" placeholder="Optional details">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">‚ûï Add Expense</button>
                </form>
            </div>

            <div class="table-container">
                <h3>Expense Record</h3>
                <table id="expenseTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Amount</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="expenseTableBody">
                        <tr>
                            <td colspan="5">
                                <div class="empty-state">
                                    <div class="empty-state-icon">üí∏</div>
                                    <h4>No expenses recorded yet</h4>
                                    <p>Start tracking your expenses above</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="form-section">
                <h3>Expense Summary</h3>
                <div class="budget-item budget-actual">
                    Daily Total: <span id="dailyExpenseTotal">‚Ç±0.00</span>
                </div>
                <div class="budget-item budget-balance">
                    Weekly Total: <span id="weeklyExpenseTotal">‚Ç±0.00</span>
                </div>
            </div>
        </div>

        <!-- BUDGET PLANNER TAB -->
        <div id="budget" class="tab-content">
            <div class="form-section">
                <h3>Set Weekly Budget</h3>
                <form id="budgetForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Expected Income (‚Ç±)</label>
                            <input type="number" id="expectedIncome" step="0.01" min="0" placeholder="13000.00">
                        </div>
                        <div class="form-group">
                            <label>Planned Expenses (‚Ç±)</label>
                            <input type="number" id="plannedExpenses" step="0.01" min="0" placeholder="8000.00">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">üíæ Update Budget</button>
                </form>
            </div>

            <div class="budget-summary">
                <h3>Budget Overview</h3>
                <div class="budget-item budget-expected">
                    Expected Income: <span id="budgetExpectedIncome">‚Ç±0.00</span>
                </div>
                <div class="budget-item budget-planned">
                    Planned Expenses: <span id="budgetPlannedExpenses">‚Ç±0.00</span>
                </div>
                <div class="budget-item budget-actual">
                    Actual Expenses: <span id="budgetActualExpenses">‚Ç±0.00</span>
                </div>
                <div class="budget-item budget-balance">
                    Remaining Balance: <span id="budgetBalance">‚Ç±0.00</span>
                </div>
                <div id="budgetAlert"></div>
            </div>
        </div>

        <!-- SUMMARY TAB -->
        <div id="summary" class="tab-content">
            <div class="form-section">
                <h3>Financial Summary Report</h3>
                
                <div class="dashboard-grid" style="margin-top: 24px;">
                    <div class="stat-card green-card">
                        <h3>Total Sales</h3>
                        <div class="amount" id="summaryTotalSales">‚Ç±0.00</div>
                    </div>
                    <div class="stat-card orange-card">
                        <h3>Total Expenses</h3>
                        <div class="amount" id="summaryTotalExpenses">‚Ç±0.00</div>
                    </div>
                    <div class="stat-card beige-card">
                        <h3>Net Income</h3>
                        <div class="amount" id="summaryNetIncome">‚Ç±0.00</div>
                    </div>
                    <div class="stat-card red-card">
                        <h3>Total Customer Debts</h3>
                        <div class="amount" id="summaryTotalDebts">‚Ç±0.00</div>
                    </div>
                </div>

                <div class="budget-summary" style="margin-top: 30px;">
                    <h3>Cash Flow Analysis</h3>
                    <div class="budget-item budget-expected">
                        Cash Sales: <span id="summaryCashSales">‚Ç±0.00</span>
                    </div>
                    <div class="budget-item budget-partial">
                        Credit Sales: <span id="summaryCreditSales">‚Ç±0.00</span>
                    </div>
                    <div class="budget-item budget-balance">
                        Profitability Margin: <span id="summaryProfitability">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- FOOTER WITH DATA MANAGEMENT -->
        <div class="footer-section">
            <div class="footer-content">
                <div class="footer-info">
                    <h4>üíæ Data Storage Information</h4>
                    <p>All your sales, expenses, and budget data are automatically saved to your browser's local storage and will persist across sessions.</p>
                </div>
                <div class="danger-zone">
                    <h4>‚ö†Ô∏è Danger Zone</h4>
                    <p>Clearing data will permanently delete all records. This action cannot be undone.</p>
                    <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // LocalStorage keys
        const STORAGE_KEYS = {
            SALES: 'riceVendor_sales',
            EXPENSES: 'riceVendor_expenses',
            BUDGET: 'riceVendor_budget'
        };

        // Data storage - load from localStorage
        let sales = loadFromStorage(STORAGE_KEYS.SALES) || [];
        let expenses = loadFromStorage(STORAGE_KEYS.EXPENSES) || [];
        let budget = loadFromStorage(STORAGE_KEYS.BUDGET) || {
            expectedIncome: 0,
            plannedExpenses: 0
        };

        // LocalStorage functions
        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
                return true;
            } catch (e) {
                console.error('Error saving to localStorage:', e);
                alert('Failed to save data. Your storage might be full.');
                return false;
            }
        }

        function loadFromStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                console.error('Error loading from localStorage:', e);
                return null;
            }
        }

        function clearAllData() {
            // First confirmation
            if (!confirm('‚ö†Ô∏è WARNING: You are about to delete ALL data!\n\nThis will permanently remove:\n‚Ä¢ All sales records\n‚Ä¢ All expense records\n‚Ä¢ All budget settings\n\nThis action CANNOT be undone!\n\nDo you want to continue?')) {
                return;
            }
            
            // Second confirmation with more emphasis
            if (!confirm('üö® SECOND WARNING!\n\nAre you absolutely sure you want to delete everything?\n\nAll your financial records will be lost forever.\n\nClick OK only if you are 100% certain.')) {
                return;
            }
            
            // Third confirmation - require typing
            const confirmation = prompt('‚ö†Ô∏è FINAL CONFIRMATION\n\nTo proceed with deleting all data, type the word:\nDELETE\n\n(Type exactly as shown in CAPITAL LETTERS)');
            
            if (confirmation !== 'DELETE') {
                alert('‚ùå Data deletion cancelled. Your data is safe.');
                return;
            }
            
            // Proceed with deletion
            try {
                localStorage.removeItem(STORAGE_KEYS.SALES);
                localStorage.removeItem(STORAGE_KEYS.EXPENSES);
                localStorage.removeItem(STORAGE_KEYS.BUDGET);
                
                sales = [];
                expenses = [];
                budget = { expectedIncome: 0, plannedExpenses: 0 };
                
                updateAllData();
                alert('‚úì All data has been permanently deleted.');
            } catch (e) {
                console.error('Error clearing data:', e);
                alert('‚ùå An error occurred while clearing data. Please try again.');
            }
        }

        // Initialize with current date
        document.getElementById('saleDate').valueAsDate = new Date();
        document.getElementById('expenseDate').valueAsDate = new Date();

        // Input validation for required fields
        function validateInput(input) {
            if (input.hasAttribute('required') && !input.value.trim()) {
                input.classList.add('invalid');
                return false;
            } else {
                input.classList.remove('invalid');
                return true;
            }
        }

        // Real-time validation
        document.querySelectorAll('input[required], select[required]').forEach(input => {
            input.addEventListener('blur', function() {
                validateInput(this);
            });
            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.classList.remove('invalid');
                }
            });
        });

        // Restrict number inputs to only accept numbers and decimals
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('keypress', function(e) {
                const char = String.fromCharCode(e.which);
                if (!/[\d.]/.test(char)) {
                    e.preventDefault();
                }
                if (char === '.' && this.value.includes('.')) {
                    e.preventDefault();
                }
            });
            
            input.addEventListener('input', function() {
                if (this.value < 0) {
                    this.value = Math.abs(this.value);
                }
            });
        });

        // Tab navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            updateAllData();
        }

        // Sales Form Submit
        document.getElementById('salesForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const requiredFields = this.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!validateInput(field)) {
                    isValid = false;
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields.');
                return;
            }
            
            const sale = {
                id: Date.now(),
                date: document.getElementById('saleDate').value,
                kilos: parseFloat(document.getElementById('saleKilos').value),
                price: parseFloat(document.getElementById('salePrice').value),
                type: document.getElementById('saleType').value,
                customer: document.getElementById('saleCustomer').value || 'N/A',
                total: parseFloat(document.getElementById('saleKilos').value) * parseFloat(document.getElementById('salePrice').value),
                paymentStatus: document.getElementById('saleType').value === 'Cash' ? 'Paid' : 'Unpaid'
            };
            
            sales.push(sale);
            saveToStorage(STORAGE_KEYS.SALES, sales);
            
            this.reset();
            document.getElementById('saleDate').valueAsDate = new Date();
            updateAllData();
        });

        // Expense Form Submit
        document.getElementById('expenseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const requiredFields = this.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!validateInput(field)) {
                    isValid = false;
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields.');
                return;
            }
            
            const expense = {
                id: Date.now(),
                date: document.getElementById('expenseDate').value,
                type: document.getElementById('expenseType').value,
                amount: parseFloat(document.getElementById('expenseAmount').value),
                description: document.getElementById('expenseDesc').value || 'N/A'
            };
            
            expenses.push(expense);
            saveToStorage(STORAGE_KEYS.EXPENSES, expenses);
            
            this.reset();
            document.getElementById('expenseDate').valueAsDate = new Date();
            updateAllData();
        });

        // Budget Form Submit
        document.getElementById('budgetForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const expectedIncome = parseFloat(document.getElementById('expectedIncome').value) || 0;
            const plannedExpenses = parseFloat(document.getElementById('plannedExpenses').value) || 0;
            
            if (expectedIncome === 0 && plannedExpenses === 0) {
                alert('Please enter at least one budget value.');
                return;
            }
            
            budget.expectedIncome = expectedIncome;
            budget.plannedExpenses = plannedExpenses;
            saveToStorage(STORAGE_KEYS.BUDGET, budget);
            
            updateAllData();
            alert('Budget updated successfully!');
        });

        // Delete Sale
        function deleteSale(id) {
            if (confirm('Are you sure you want to delete this sale record?')) {
                sales = sales.filter(s => s.id !== id);
                saveToStorage(STORAGE_KEYS.SALES, sales);
                updateAllData();
            }
        }

        // Delete Expense
        function deleteExpense(id) {
            if (confirm('Are you sure you want to delete this expense record?')) {
                expenses = expenses.filter(e => e.id !== id);
                saveToStorage(STORAGE_KEYS.EXPENSES, expenses);
                updateAllData();
            }
        }

        // Update Payment Status
        function updatePaymentStatus(id, status) {
            const sale = sales.find(s => s.id === id);
            if (sale) {
                sale.paymentStatus = status;
                saveToStorage(STORAGE_KEYS.SALES, sales);
                updateAllData();
            }
        }

        // Format currency
        function formatCurrency(amount) {
            return `‚Ç±${amount.toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        // Calculate totals
        function calculateTotals() {
            const today = new Date().toISOString().split('T')[0];
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            const todaySales = sales
                .filter(s => s.date === today)
                .reduce((sum, s) => sum + s.total, 0);
            
            const weeklyIncome = sales
                .filter(s => s.date >= weekAgo)
                .reduce((sum, s) => sum + s.total, 0);
            
            const totalExpenses = expenses
                .filter(e => e.date >= weekAgo)
                .reduce((sum, e) => sum + e.amount, 0);
            
            const customerDebts = sales
                .filter(s => s.type === 'Credit' && s.paymentStatus !== 'Paid')
                .reduce((sum, s) => sum + s.total, 0);
            
            return { todaySales, weeklyIncome, totalExpenses, customerDebts };
        }

        // Update all data displays
        function updateAllData() {
            const totals = calculateTotals();
            
            document.getElementById('todaySales').textContent = formatCurrency(totals.todaySales);
            document.getElementById('weeklyIncome').textContent = formatCurrency(totals.weeklyIncome);
            document.getElementById('totalExpenses').textContent = formatCurrency(totals.totalExpenses);
            document.getElementById('customerDebts').textContent = formatCurrency(totals.customerDebts);
            document.getElementById('netProfit').textContent = formatCurrency(totals.weeklyIncome - totals.totalExpenses);
            
            updateSalesTable();
            updateCreditTable();
            updateExpenseTable();
            updateWeeklyChart();
            updateBudgetDisplay();
            updateSummaryTab();
        }

        // Update sales table
        function updateSalesTable() {
            const tbody = document.getElementById('salesTableBody');
            tbody.innerHTML = '';
            
            if (sales.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7">
                            <div class="empty-state">
                                <div class="empty-state-icon">üìä</div>
                                <h4>No sales recorded yet</h4>
                                <p>Start by adding your first sale above</p>
                            </div>
                        </td>
                    </tr>
                `;
                document.getElementById('dailySalesTotal').textContent = formatCurrency(0);
                document.getElementById('weeklySalesTotal').textContent = formatCurrency(0);
                return;
            }
            
            sales.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(sale => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${sale.date}</td>
                    <td>${sale.kilos} kg</td>
                    <td>${formatCurrency(sale.price)}</td>
                    <td>${sale.type}</td>
                    <td>${sale.customer}</td>
                    <td><strong>${formatCurrency(sale.total)}</strong></td>
                    <td><button class="btn btn-danger" onclick="deleteSale(${sale.id})">üóëÔ∏è Delete</button></td>
                `;
            });
            
            const today = new Date().toISOString().split('T')[0];
            const dailyTotal = sales
                .filter(s => s.date === today)
                .reduce((sum, s) => sum + s.total, 0);
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const weeklyTotal = sales
                .filter(s => s.date >= weekAgo)
                .reduce((sum, s) => sum + s.total, 0);
            
            document.getElementById('dailySalesTotal').textContent = formatCurrency(dailyTotal);
            document.getElementById('weeklySalesTotal').textContent = formatCurrency(weeklyTotal);
        }

        // Update credit table
        function updateCreditTable() {
            const tbody = document.getElementById('creditTableBody');
            tbody.innerHTML = '';
            
            const creditSales = sales.filter(s => s.type === 'Credit');
            
            if (creditSales.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <div class="empty-state-icon">üí≥</div>
                                <h4>No credit transactions yet</h4>
                                <p>Credit sales will appear here</p>
                            </div>
                        </td>
                    </tr>
                `;
                document.getElementById('totalOutstanding').textContent = formatCurrency(0);
                return;
            }
            
            let totalOutstanding = 0;
            
            creditSales.forEach(sale => {
                const status = sale.paymentStatus || 'Unpaid';
                if (status !== 'Paid') {
                    totalOutstanding += sale.total;
                }
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td><strong>${sale.customer}</strong></td>
                    <td>${formatCurrency(sale.total)}</td>
                    <td>${sale.date}</td>
                    <td><span class="status-badge status-${status.toLowerCase()}">${status}</span></td>
                    <td>
                        <select onchange="updatePaymentStatus(${sale.id}, this.value)" style="padding: 8px 12px; border-radius: 8px; border: 2px solid #e1e8ed; font-family: 'Inter', sans-serif; font-weight: 600;">
                            <option value="Unpaid" ${status === 'Unpaid' ? 'selected' : ''}>Unpaid</option>
                            <option value="Partial" ${status === 'Partial' ? 'selected' : ''}>Partial</option>
                            <option value="Paid" ${status === 'Paid' ? 'selected' : ''}>Paid</option>
                        </select>
                    </td>
                `;
            });
            
            document.getElementById('totalOutstanding').textContent = formatCurrency(totalOutstanding);
        }

        // Update expense table
        function updateExpenseTable() {
            const tbody = document.getElementById('expenseTableBody');
            tbody.innerHTML = '';
            
            if (expenses.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <div class="empty-state-icon">üí∏</div>
                                <h4>No expenses recorded yet</h4>
                                <p>Start tracking your expenses above</p>
                            </div>
                        </td>
                    </tr>
                `;
                document.getElementById('dailyExpenseTotal').textContent = formatCurrency(0);
                document.getElementById('weeklyExpenseTotal').textContent = formatCurrency(0);
                return;
            }
            
            expenses.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(expense => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${expense.date}</td>
                    <td><strong>${expense.type}</strong></td>
                    <td>${expense.description}</td>
                    <td><strong>${formatCurrency(expense.amount)}</strong></td>
                    <td><button class="btn btn-danger" onclick="deleteExpense(${expense.id})">üóëÔ∏è Delete</button></td>
                `;
            });
            
            const today = new Date().toISOString().split('T')[0];
            const dailyTotal = expenses
                .filter(e => e.date === today)
                .reduce((sum, e) => sum + e.amount, 0);
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const weeklyTotal = expenses
                .filter(e => e.date >= weekAgo)
                .reduce((sum, e) => sum + e.amount, 0);
            
            document.getElementById('dailyExpenseTotal').textContent = formatCurrency(dailyTotal);
            document.getElementById('weeklyExpenseTotal').textContent = formatCurrency(weeklyTotal);
        }

        // Update weekly chart
        function updateWeeklyChart() {
            const chart = document.getElementById('weeklyChart');
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const maxHeight = 260;
            
            chart.innerHTML = '';
            
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
            const dailyData = days.map((day, index) => {
                const date = new Date(weekAgo);
                date.setDate(date.getDate() + index);
                const dateStr = date.toISOString().split('T')[0];
                
                const income = sales
                    .filter(s => s.date === dateStr)
                    .reduce((sum, s) => sum + s.total, 0);
                    
                const expense = expenses
                    .filter(e => e.date === dateStr)
                    .reduce((sum, e) => sum + e.amount, 0);
                
                return { day, income, expense };
            });
            
            const maxValue = Math.max(
                ...dailyData.map(d => Math.max(d.income, d.expense)),
                100
            );
            
            dailyData.forEach(({ day, income, expense }) => {
                const barGroup = document.createElement('div');
                barGroup.className = 'bar-group';
                
                const incomeHeight = (income / maxValue) * maxHeight;
                const expenseHeight = (expense / maxValue) * maxHeight;
                
                barGroup.innerHTML = `
                    <div class="bars">
                        <div class="bar income-bar" style="height: ${incomeHeight}px;" title="Income: ${formatCurrency(income)}"></div>
                        <div class="bar expense-bar" style="height: ${expenseHeight}px;" title="Expense: ${formatCurrency(expense)}"></div>
                    </div>
                    <div class="day-label">${day}</div>
                `;
                
                chart.appendChild(barGroup);
            });
        }

        // Update budget display
        function updateBudgetDisplay() {
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            const actualExpenses = expenses
                .filter(e => e.date >= weekAgo)
                .reduce((sum, e) => sum + e.amount, 0);
            
            const balance = budget.expectedIncome - actualExpenses;
            
            document.getElementById('budgetExpectedIncome').textContent = formatCurrency(budget.expectedIncome);
            document.getElementById('budgetPlannedExpenses').textContent = formatCurrency(budget.plannedExpenses);
            document.getElementById('budgetActualExpenses').textContent = formatCurrency(actualExpenses);
            document.getElementById('budgetBalance').textContent = formatCurrency(balance);
            
            const alertDiv = document.getElementById('budgetAlert');
            if (actualExpenses > budget.plannedExpenses && budget.plannedExpenses > 0) {
                alertDiv.innerHTML = '<div class="alert alert-danger">‚ö†Ô∏è Warning: You have exceeded your planned budget!</div>';
            } else if (actualExpenses > budget.plannedExpenses * 0.9 && budget.plannedExpenses > 0) {
                alertDiv.innerHTML = '<div class="alert alert-warning">‚ö†Ô∏è Caution: You are approaching your budget limit (90%)</div>';
            } else if (budget.plannedExpenses > 0) {
                alertDiv.innerHTML = '<div class="alert alert-success">‚úì Good job! You are staying within your budget</div>';
            } else {
                alertDiv.innerHTML = '';
            }
        }

        // Update summary tab
        function updateSummaryTab() {
            const totalSales = sales.reduce((sum, s) => sum + s.total, 0);
            const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);
            const netIncome = totalSales - totalExpenses;
            const totalDebts = sales
                .filter(s => s.type === 'Credit' && s.paymentStatus !== 'Paid')
                .reduce((sum, s) => sum + s.total, 0);
            
            const cashSales = sales.filter(s => s.type === 'Cash').reduce((sum, s) => sum + s.total, 0);
            const creditSales = sales.filter(s => s.type === 'Credit').reduce((sum, s) => sum + s.total, 0);
            const profitability = totalSales > 0 ? ((netIncome / totalSales) * 100).toFixed(2) : 0;
            
            document.getElementById('summaryTotalSales').textContent = formatCurrency(totalSales);
            document.getElementById('summaryTotalExpenses').textContent = formatCurrency(totalExpenses);
            document.getElementById('summaryNetIncome').textContent = formatCurrency(netIncome);
            document.getElementById('summaryTotalDebts').textContent = formatCurrency(totalDebts);
            document.getElementById('summaryCashSales').textContent = formatCurrency(cashSales);
            document.getElementById('summaryCreditSales').textContent = formatCurrency(creditSales);
            document.getElementById('summaryProfitability').textContent = `${profitability}%`;
        }

        // Initialize - load budget values into form if they exist
        if (budget.expectedIncome > 0) {
            document.getElementById('expectedIncome').value = budget.expectedIncome;
        }
        if (budget.plannedExpenses > 0) {
            document.getElementById('plannedExpenses').value = budget.plannedExpenses;
        }

        // Initialize display
        updateAllData();
    </script>
</body>
</html>